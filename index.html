<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gerenciamento de Assentos - Cinema</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f4f4f4;
            margin: 0;
            padding: 20px;
            text-align: center;
        }
        h1 {
            margin-bottom: 20px;
        }
        .screen {
            width: 100%;
            height: 50px;
            background-color: #333;
            color: white;
            line-height: 50px;
            margin-top: 20px; /* Mova o púlpito para baixo */
        }
        .row {
            display: flex;
            justify-content: center;
            margin-bottom: 10px;
        }
        .seat {
            display: inline-block;
            width: 40px;
            height: 40px;
            margin: 5px;
            background-color: #28a745;
            color: white;
            text-align: center;
            line-height: 40px;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        .occupied {
            background-color: #dc3545;
            cursor: not-allowed; /* Muda o cursor para indicar que o assento não é selecionável */
        }
        .header {
            display: flex;
            justify-content: center;
            margin-bottom: 10px;
        }
        .header div {
            width: 40px;
            height: 40px;
            margin: 5px;
            line-height: 40px;
            font-weight: bold;
            border: 1px solid #ccc;
        }
        .controls {
            margin-top: 20px;
        }
        input[type="button"], input[type="number"] {
            padding: 10px 20px;
            margin: 5px;
        }
        input[type="button"] {
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        input[type="button"]:disabled {
            background-color: #ccc;
        }
    </style>
</head>
<body>

<h1>Gerenciamento de Assentos - Cinema</h1>

<!-- Cabeçalho com números das colunas -->
<div class="header">
    <div></div> <!-- Espaço para o rótulo da fila -->
    <div>1</div>
    <div>2</div>
    <div>3</div>
    <div>4</div>
    <div>5</div>
    <div>6</div>
    <div>7</div>
    <div>8</div>
</div>

<div id="seats"></div>

<div class="screen">Púpito</div>

<div class="controls">
    <input type="number" id="peopleCount" placeholder="Quantidade de pessoas" min="1" max="40" step="1">
    <input type="button" id="setCountButton" value="Definir Quantidade">
</div>

<div class="controls" id="reservationControls" style="display: none;">
    <input type="button" id="confirmButton" value="Confirmar Assentos" disabled>
    <input type="button" id="editButton" value="Editar Seleção" disabled>
</div>

<script>
    const rows = 5;
    const cols = 8;
    const seats = Array.from({ length: rows }, () => Array(cols).fill(null));
    const seatsContainer = document.getElementById('seats');
    const confirmButton = document.getElementById('confirmButton');
    const editButton = document.getElementById('editButton');
    const peopleCountInput = document.getElementById('peopleCount');
    const setCountButton = document.getElementById('setCountButton');
    const reservationControls = document.getElementById('reservationControls');
    const rowLabels = ['E', 'D', 'C', 'B', 'A']; // Inverte a ordem das fileiras

    let selectedSeats = [];
    let maxSelections = 0;

    function renderSeats() {
        seatsContainer.innerHTML = '';
        for (let i = 0; i < rows; i++) {
            const rowDiv = document.createElement('div');
            rowDiv.className = 'row';
            const rowLabel = document.createElement('div');
            rowLabel.textContent = rowLabels[i];
            rowLabel.style.marginRight = '10px'; // Espaço entre a letra e os assentos
            rowDiv.appendChild(rowLabel);
            for (let j = 0; j < cols; j++) {
                const seatDiv = document.createElement('div');
                seatDiv.className = 'seat' + (seats[i][j] ? ' occupied' : '');
                seatDiv.textContent = seats[i][j] ? '' : `${rowLabels[i]}${j + 1}`; // Exibe E1, D1, ...
                seatDiv.onclick = () => {
                    if (!seats[i][j]) toggleSeat(i, j); // Permite selecionar apenas se o assento estiver disponível
                };
                rowDiv.appendChild(seatDiv);
            }
            seatsContainer.appendChild(rowDiv);
        }
    }

    function toggleSeat(row, col) {
        const seatIndex = selectedSeats.findIndex(seat => seat.row === row && seat.col === col);
        if (seatIndex === -1) {
            if (selectedSeats.length < maxSelections) {
                selectedSeats.push({ row, col });
                seats[row][col] = 'Ocupado'; // Marca o assento como ocupado
            } else {
                alert(`Você pode selecionar apenas ${maxSelections} assentos.`);
            }
        } else {
            // Desmarca o assento se já estiver na seleção
            selectedSeats.splice(seatIndex, 1);
            seats[row][col] = null; // Desmarca o assento
        }
        renderSeats();
        confirmButton.disabled = selectedSeats.length === 0;
        editButton.disabled = selectedSeats.length === 0;
    }

    setCountButton.onclick = () => {
        const count = parseInt(peopleCountInput.value);
        if (count > 0 && count <= 40) {
            maxSelections = count;
            reservationControls.style.display = 'block';
            selectedSeats = [];
            renderSeats();
            confirmButton.disabled = true;
            editButton.disabled = true;
            setCountButton.value = `Quantidade de Assentos Definidos: ${maxSelections}`; // Atualiza o texto do botão
        } else {
            alert('Por favor, insira um número válido de pessoas (1 a 40).');
        }
    };

    confirmButton.onclick = () => {
        if (selectedSeats.length > 0) {
            const seatNumbers = selectedSeats.map(seat => `${rowLabels[seat.row]}${seat.col + 1}`).join(', ');
            alert(`Assentos ${seatNumbers} confirmados!`);

            // Marca os assentos como ocupados
            selectedSeats.forEach(seat => {
                seats[seat.row][seat.col] = 'Ocupado'; // Marca o assento como ocupado permanentemente
            });
            resetSelections(); // Reinicia o programa mantendo os assentos ocupados
        } else {
            alert('Nenhum assento foi selecionado.');
        }
    };

    editButton.onclick = () => {
        selectedSeats = [];
        confirmButton.disabled = true;
        editButton.disabled = true;
        renderSeats();
    };

    function resetSelections() {
        selectedSeats = []; // Limpa as seleções
        maxSelections = 0; // Reseta a seleção máxima
        peopleCountInput.value = ''; // Limpa o campo de entrada
        reservationControls.style.display = 'none'; // Esconde os controles de reserva
        setCountButton.value = 'Definir Quantidade'; // Restaura o texto do botão
        renderSeats(); // Renderiza os assentos novamente
    }

    renderSeats();
</script>

</body>
</html>